
{%macro page(page_link, p)%}
{% if page_link == p.current%}
   <a class="current">{{page_link}}</a>{% else %}
   <a href="{{p.current_url}}/page={{page_link}}">{{page_link}}</a>{% endif %}
{%endmacro%}


{% macro make(_first, _end, p)%}
{% if (p.current - (p.count_link/2)) > 1 %}
   <a class="first" href="{{p.current_url}}/page=1">{%trans "First page"%}</a>{% endif %}
{% if p.current > 1 %}
   <a class="prev" rel="prev" href="{{p.current_url}}/page={{p.prev}}">«</a>{% endif %}

{%for i in _first.._end%}
{{_self.page(i, p)}}
{%endfor%}
{% if p.current != p.total_pages %}
   <a class="next" rel="next" href="{{p.current_url}}/page={{p.next}}">»</a>
{% endif %}
{% if (p.current + (p.count_link/2)) < p.total_pages %}
   <a class="last" href="{{p.current_url}}/page={{p.total_pages}}">{%trans "Last page"%}</a>
{% endif %}
{%endmacro%}


{% if pagnation.total_pages > 1%}
  <nav class="pagination">
{% if pagnation.count_link >= pagnation.total_pages%}
{{_self.make(1, pagnation.total_pages, pagnation)}}

{% elseif pagnation.current < (pagnation.count_link/2) %}
{{_self.make(1, pagnation.count_link, pagnation)}}
{% elseif (pagnation.current + (pagnation.count_link/2)| round(0, 'floor')) > pagnation.total_pages  %}
{{_self.make(pagnation.total_pages - pagnation.count_link, pagnation.total_pages, pagnation)}}

{% else %}
{{_self.make(pagnation.current - (pagnation.count_link/2) | round(0, 'floor'), pagnation.current + (pagnation.count_link/2) | round(0, 'floor'), pagnation)}}
{% endif %}
  </nav>
{% endif %}
